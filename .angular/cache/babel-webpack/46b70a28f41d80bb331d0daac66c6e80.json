{"ast":null,"code":"import { Permissao, Usuario } from 'src/app/core-module/model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"primeng/api\";\nimport * as i2 from \"src/app/core-module/error-handler.service\";\nimport * as i3 from \"../usuario.service\";\nimport * as i4 from \"../permissao.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/platform-browser\";\nimport * as i7 from \"primeng/toast\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"primeng/inputtext\";\nimport * as i10 from \"../../shared/message/message.component\";\nimport * as i11 from \"primeng/picklist\";\nimport * as i12 from \"primeng/button\";\n\nfunction CadastroUsuarioComponent_ng_template_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵelement(1, \"div\", 27);\n    i0.ɵɵelementStart(2, \"div\", 28);\n    i0.ɵɵelementStart(3, \"h5\", 29);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 30);\n    i0.ɵɵelement(6, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const permissao_r6 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(permissao_r6.descricao);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassMap(\"product-badge status-\" + permissao_r6.descricao.toLowerCase());\n  }\n}\n\nconst _c0 = function () {\n  return {\n    \"height\": \"30rem\"\n  };\n};\n\nexport let CadastroUsuarioComponent = /*#__PURE__*/(() => {\n  class CadastroUsuarioComponent {\n    constructor(messageService, errorHandleService, usuarioService, permissoesService, route, navigateRoute, title) {\n      this.messageService = messageService;\n      this.errorHandleService = errorHandleService;\n      this.usuarioService = usuarioService;\n      this.permissoesService = permissoesService;\n      this.route = route;\n      this.navigateRoute = navigateRoute;\n      this.title = title;\n      this.senhaConfirmar = '';\n      this.permissoesDoUsuario = [];\n      this.msgs1 = [];\n      this.usuario = new Usuario();\n    }\n\n    ngOnInit() {\n      this.title.setTitle('Novo Usuário');\n      const condigoUsuario = this.route.snapshot.params['codigo'];\n\n      if (condigoUsuario) {\n        this.carregarUsuario(condigoUsuario);\n      }\n\n      this.carregarPermissoes();\n      this.msgs1 = [{\n        severity: 'error',\n        summary: 'Error',\n        detail: 'Message Content'\n      }];\n    }\n\n    verificarSenha() {\n      if (this.usuario.senha) {\n        if (this.senhaConfirmar === this.usuario.senha) {\n          return true;\n        } else {\n          this.errorHandleService.handle('Senhas não conferem.');\n        }\n      }\n\n      return false;\n    }\n\n    salvar(form) {\n      if (this.verificarSenha()) {\n        if (this.editando) {\n          console.log('estou aqui');\n          this.atualizarUsuario(form);\n        } else {\n          this.adicionarUsuario(form);\n        }\n      }\n    }\n\n    adicionarUsuario(form) {\n      if (!(this.usuario.permissoes.length > 0)) {\n        let permStandad = new Permissao();\n        permStandad.codigo = 3;\n        let newPermissao = [permStandad];\n        this.usuario.permissoes = newPermissao;\n      }\n\n      this.usuarioService.adicionar(this.usuario).then(() => {\n        form.reset();\n        this.usuario = new Usuario();\n      }).catch(erro => this.errorHandleService.handle(erro));\n    }\n\n    atualizarUsuario(form) {\n      console.log('Estou aqui.');\n      this.usuarioService.atualizar(this.usuario).then(usuario => {\n        this.usuario = new Usuario();\n        form.reset();\n        this.navigateRoute.navigate(['/usuario/pesquisar']);\n      }).catch(erro => this.errorHandleService.handle(erro));\n    }\n\n    get editando() {\n      return Boolean(this.usuario.codigo);\n    }\n\n    carregarUsuario(codigo) {\n      this.usuarioService.buscarPorCodigo(codigo).then(usuario => {\n        this.usuario = usuario;\n        this.permissoesDoUsuario = this.usuario.permissoes;\n        this.usuario.senha = '';\n      }).catch(erro => this.errorHandleService.handle(erro));\n    }\n\n    novo(form) {\n      form.reset();\n      this.usuario = new Usuario();\n      this.navigateRoute.navigate(['usuario/novo']);\n    }\n\n    carregarPermissoes() {\n      return this.permissoesService.listarTodas().then(permissoes => {\n        this.permissoes = permissoes;\n\n        for (let index = 0; index < this.usuario.permissoes.length; index++) {\n          const up = this.usuario.permissoes[index];\n          this.permissoes.forEach((p, id) => {\n            if (p.descricao === up.descricao) {\n              console.log(p.descricao + ' - ' + up.descricao);\n              this.permissoes.splice(id, 1);\n            }\n          });\n        }\n      }).catch(erro => this.errorHandleService.handle(erro));\n    }\n\n  }\n\n  CadastroUsuarioComponent.ɵfac = function CadastroUsuarioComponent_Factory(t) {\n    return new (t || CadastroUsuarioComponent)(i0.ɵɵdirectiveInject(i1.MessageService), i0.ɵɵdirectiveInject(i2.ErrorHandlerService), i0.ɵɵdirectiveInject(i3.UsuarioService), i0.ɵɵdirectiveInject(i4.PermissaoService), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i6.Title));\n  };\n\n  CadastroUsuarioComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CadastroUsuarioComponent,\n    selectors: [[\"app-cadastro-usuario\"]],\n    decls: 50,\n    vars: 30,\n    consts: [[\"position\", \"bottom-left\"], [1, \"container\"], [1, \"card-container\", 2, \"padding\", \"10px 0 10px\"], [1, \"p-grid\", \"box\", \"shadow-5\", \"m-1\", 2, \"padding\", \"20px\"], [\"autocomplete\", \"off\", 3, \"ngSubmit\"], [\"f\", \"ngForm\"], [1, \"formgrid\", \"grid\"], [1, \"field\", \"col-12\", \"md:col-6\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"nome\", \"ngModel\", \"\", \"minlength\", \"5\", 1, \"inputfield\", \"w-full\", 3, \"required\", \"ngModel\", \"ngModelChange\"], [\"nome\", \"ngModel\"], [\"error\", \"required\", \"text\", \"Informe o nome do Usu\\u00E1rio.\", 3, \"control\"], [\"error\", \"minlength\", 3, \"control\", \"text\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"email\", \"ngModel\", \"\", \"minlength\", \"5\", 1, \"inputfield\", \"w-full\", 3, \"required\", \"ngModel\", \"ngModelChange\"], [\"email\", \"ngModel\"], [\"error\", \"required\", \"text\", \"Informe o nome igualmente ao registro do livro.\", 3, \"control\"], [1, \"field\", \"col-6\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"senha\", \"ngModel\", \"\", \"minlength\", \"4\", 1, \"inputfield\", \"w-full\", 3, \"required\", \"ngModel\", \"ngModelChange\"], [\"senha\", \"ngModel\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"confirmar\", \"ngModel\", \"\", \"minlength\", \"4\", 1, \"inputfield\", \"w-full\", 3, \"required\", \"ngModel\", \"ngModelChange\"], [\"confirmar\", \"ngModel\"], [1, \"field\", \"col-12\"], [\"sourceHeader\", \"Permiss\\u00F5es Dispon\\u00EDveis\", \"targetHeader\", \"Permiss\\u00F5es Selecionadas\", \"filterBy\", \"descricao\", \"sourceFilterPlaceholder\", \"Pesquisar por Nome\", \"targetFilterPlaceholder\", \"Pesquisar por Nome\", 3, \"source\", \"target\", \"dragdrop\", \"responsive\", \"sourceStyle\", \"targetStyle\"], [\"pTemplate\", \"item\"], [\"pButton\", \"\", \"type\", \"submit\", \"label\", \"Salvar\", \"action\", \"\", 3, \"disabled\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Novo\", 1, \"p-button-info\", 3, \"click\"], [\"routerLink\", \"/usuario/pesquisar\"], [1, \"product-item\"], [1, \"image-container\"], [1, \"product-list-detail\"], [1, \"p-mb-2\"], [1, \"product-list-action\"]],\n    template: function CadastroUsuarioComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r7 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelement(0, \"p-toast\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\");\n        i0.ɵɵelementStart(5, \"form\", 4, 5);\n        i0.ɵɵlistener(\"ngSubmit\", function CadastroUsuarioComponent_Template_form_ngSubmit_5_listener() {\n          i0.ɵɵrestoreView(_r7);\n\n          const _r0 = i0.ɵɵreference(6);\n\n          return ctx.salvar(_r0);\n        });\n        i0.ɵɵelementStart(7, \"div\");\n        i0.ɵɵelementStart(8, \"h1\");\n        i0.ɵɵtext(9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 6);\n        i0.ɵɵelementStart(11, \"div\", 7);\n        i0.ɵɵelementStart(12, \"label\");\n        i0.ɵɵtext(13, \"Nome do Usu\\u00E1rio\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"input\", 8, 9);\n        i0.ɵɵlistener(\"ngModelChange\", function CadastroUsuarioComponent_Template_input_ngModelChange_14_listener($event) {\n          return ctx.usuario.nome = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"app-message\", 10);\n        i0.ɵɵelement(17, \"app-message\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 7);\n        i0.ɵɵelementStart(19, \"label\");\n        i0.ɵɵtext(20, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"input\", 12, 13);\n        i0.ɵɵlistener(\"ngModelChange\", function CadastroUsuarioComponent_Template_input_ngModelChange_21_listener($event) {\n          return ctx.usuario.email = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(23, \"app-message\", 14);\n        i0.ɵɵelement(24, \"app-message\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 15);\n        i0.ɵɵelementStart(26, \"label\");\n        i0.ɵɵtext(27, \"Senha\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"input\", 16, 17);\n        i0.ɵɵlistener(\"ngModelChange\", function CadastroUsuarioComponent_Template_input_ngModelChange_28_listener($event) {\n          return ctx.usuario.senha = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(30, \"app-message\", 14);\n        i0.ɵɵelement(31, \"app-message\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"div\", 15);\n        i0.ɵɵelementStart(33, \"label\");\n        i0.ɵɵtext(34, \"Senha\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"input\", 18, 19);\n        i0.ɵɵlistener(\"ngModelChange\", function CadastroUsuarioComponent_Template_input_ngModelChange_35_listener($event) {\n          return ctx.senhaConfirmar = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(37, \"app-message\", 14);\n        i0.ɵɵelement(38, \"app-message\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"div\", 20);\n        i0.ɵɵelementStart(40, \"div\");\n        i0.ɵɵelementStart(41, \"h1\");\n        i0.ɵɵtext(42, \"Permiss\\u00F5es\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"p-pickList\", 21);\n        i0.ɵɵtemplate(44, CadastroUsuarioComponent_ng_template_44_Template, 7, 3, \"ng-template\", 22);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(45, \"div\", 15);\n        i0.ɵɵelement(46, \"button\", 23);\n        i0.ɵɵelementStart(47, \"button\", 24);\n        i0.ɵɵlistener(\"click\", function CadastroUsuarioComponent_Template_button_click_47_listener() {\n          i0.ɵɵrestoreView(_r7);\n\n          const _r0 = i0.ɵɵreference(6);\n\n          return ctx.novo(_r0);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(48, \"a\", 25);\n        i0.ɵɵtext(49, \"voltar para pesquisa\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(6);\n\n        const _r1 = i0.ɵɵreference(15);\n\n        const _r2 = i0.ɵɵreference(22);\n\n        const _r3 = i0.ɵɵreference(29);\n\n        const _r4 = i0.ɵɵreference(36);\n\n        i0.ɵɵadvance(9);\n        i0.ɵɵtextInterpolate1(\" \", ctx.editando ? \"Edi\\u00E7\\u00E3o de\" : \"Novo\", \" Usu\\u00E1rio\");\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"required\", true)(\"ngModel\", ctx.usuario.nome);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"control\", _r1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵpropertyInterpolate1(\"text\", \"Informe o nome com m\\u00EDnimo de \", _r1.errors == null ? null : _r1.errors[\"minlength\"] == null ? null : _r1.errors[\"minlength\"].requiredLength, \" caracteres.\");\n        i0.ɵɵproperty(\"control\", _r1);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"required\", true)(\"ngModel\", ctx.usuario.email);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"control\", _r2);\n        i0.ɵɵadvance(1);\n        i0.ɵɵpropertyInterpolate1(\"text\", \"Informe o nome com m\\u00EDnimo de \", _r2.errors == null ? null : _r2.errors[\"minlength\"] == null ? null : _r2.errors[\"minlength\"].requiredLength, \" caracteres.\");\n        i0.ɵɵproperty(\"control\", _r2);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"required\", false)(\"ngModel\", ctx.usuario.senha);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"control\", _r3);\n        i0.ɵɵadvance(1);\n        i0.ɵɵpropertyInterpolate1(\"text\", \"Informe o nome com m\\u00EDnimo de \", _r3.errors == null ? null : _r3.errors[\"minlength\"] == null ? null : _r3.errors[\"minlength\"].requiredLength, \" caracteres.\");\n        i0.ɵɵproperty(\"control\", _r3);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"required\", false)(\"ngModel\", ctx.senhaConfirmar);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"control\", _r4);\n        i0.ɵɵadvance(1);\n        i0.ɵɵpropertyInterpolate1(\"text\", \"Informe o nome com m\\u00EDnimo de \", _r4.errors == null ? null : _r4.errors[\"minlength\"] == null ? null : _r4.errors[\"minlength\"].requiredLength, \" caracteres.\");\n        i0.ɵɵproperty(\"control\", _r4);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"source\", ctx.permissoes)(\"target\", ctx.permissoesDoUsuario)(\"dragdrop\", true)(\"responsive\", true)(\"sourceStyle\", i0.ɵɵpureFunction0(28, _c0))(\"targetStyle\", i0.ɵɵpureFunction0(29, _c0));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", _r0.invalid);\n      }\n    },\n    directives: [i7.Toast, i8.ɵNgNoValidate, i8.NgControlStatusGroup, i8.NgForm, i8.DefaultValueAccessor, i9.InputText, i8.NgControlStatus, i8.NgModel, i8.MinLengthValidator, i8.RequiredValidator, i10.MessageComponent, i11.PickList, i1.PrimeTemplate, i12.ButtonDirective, i5.RouterLinkWithHref],\n    styles: [\"\"]\n  });\n  return CadastroUsuarioComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}